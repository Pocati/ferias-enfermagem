<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestão de Férias - Enfermagem</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <style>
        :root {
            --primary: #c62828;
            --secondary: #d32f2f;
            --accent: #ef5350;
            --light: #ffcdd2;
            --dark: #b71c1c;
            --danger: #e53935;
            --success: #43a047;
            --warning: #ff8f00;
            --gray: #f5f5f5;
            --text: #212121;
            --vacation: #e8f5e9;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #fafafa;
            color: var(--text);
            line-height: 1.6;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        .container {
            width: 90%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
        }

        header {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        h1 {
            color: white !important;
        }

        .search-container {
            display: flex;
            align-items: center;
            position: relative;
        }

        .search-bar {
            display: flex;
            background: white;
            border-radius: 4px;
            overflow: hidden;
        }

        .search-bar input {
            border: none;
            padding: 10px 15px;
            width: 250px;
            outline: none;
        }

        .search-bar button {
            background: var(--accent);
            border: none;
            color: white;
            padding: 10px 15px;
            cursor: pointer;
        }

        .search-results-container {
            position: absolute;
            top: 100%;
            left: 0;
            background: white;
            border-radius: 4px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
            max-height: 300px;
            overflow-y: auto;
            z-index: 1000;
            margin-top: 5px;
            width: 100%;
        }

        .search-result-item {
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .search-result-item:hover {
            background-color: #f5f5f5;
        }

        .card {
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            padding: 20px;
            margin-bottom: 20px;
        }

        .form-group {
            margin-bottom: 15px;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 600;
        }

        input,
        select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
        }

        button {
            background-color: var(--primary);
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background-color 0.3s;
        }

        button:hover {
            background-color: var(--secondary);
        }

        /* Navbar de enfermarias */
        .wards-navbar {
            display: flex;
            overflow-x: auto;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            padding: 10px;
        }

        .ward-tab {
            padding: 10px 15px;
            background-color: var(--light);
            border-radius: 6px;
            cursor: pointer;
            margin-right: 10px;
            white-space: nowrap;
        }

        .ward-tab.active {
            background-color: var(--primary);
            color: white;
        }

        /* Filtro de turnos */
        .shift-filter {
            display: flex;
            margin-bottom: 20px;
            gap: 10px;
        }

        .shift-tab {
            padding: 10px 15px;
            background-color: var(--light);
            border-radius: 6px;
            cursor: pointer;
        }

        .shift-tab.active {
            background-color: var(--primary);
            color: white;
        }

        /* Layout principal */
        .main-layout {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 30px;
        }

        .vacation-section {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }

        .vacation-card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            padding: 15px;
        }

        .toggle-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            user-select: none;
        }

        .toggle-content {
            margin-top: 10px;
        }

        .toggle-content.hidden {
            display: none;
        }

        .vacation-list {
            margin-top: 10px;
        }

        .vacation-item {
            padding: 10px;
            border-bottom: 1px solid #eee;
        }

        /* Quadro de funcionários */
        .employees-board {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .employee-list {
            min-height: 100px;
            padding: 10px;
            border: 1px dashed #ddd;
            border-radius: 6px;
            background-color: #f9f9f9;
        }

        .employee-item {
            background-color: white;
            padding: 10px;
            margin-bottom: 8px;
            border-radius: 4px;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .employee-item.on-vacation {
            background-color: var(--vacation);
            border-left: 4px solid var(--success);
        }

        .employee-name {
            font-weight: 500;
        }

        .employee-role {
            font-size: 12px;
            color: #777;
        }

        .employee-actions {
            display: flex;
            gap: 5px;
        }

        button.delete-btn {
            background-color: transparent;
            color: var(--danger);
            padding: 5px;
        }

        button.edit-btn {
            background-color: transparent;
            color: var(--secondary);
            padding: 5px;
        }

        button.move-btn {
            background-color: transparent;
            color: var(--primary);
            padding: 5px;
        }

        .alert {
            padding: 15px;
            margin: 20px 0;
            border-radius: 4px;
            background-color: #fff4e6;
            border-left: 4px solid var(--warning);
            position: relative;
        }

        .alert.hidden {
            display: none;
        }

        .alert-toggle {
            position: absolute;
            right: 15px;
            top: 15px;
            background: none;
            border: none;
            color: inherit;
            cursor: pointer;
        }

        .empty-state {
            text-align: center;
            padding: 20px;
            color: #757575;
        }

        .requirements {
            font-size: 14px;
            color: #757575;
            margin-top: 5px;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            justify-content: center;
            align-items: center;
        }

        .modal-content {
            background-color: white;
            padding: 25px;
            border-radius: 8px;
            width: 90%;
            max-width: 500px;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .close {
            font-size: 24px;
            cursor: pointer;
        }

        footer {
            background: linear-gradient(135deg, var(--primary), var(--dark));
            color: white;
            text-align: center;
            padding: 15px;
            margin-top: 30px;
        }

        @media (max-width: 768px) {
            .main-layout {
                grid-template-columns: 1fr;
            }

            .employees-board {
                grid-template-columns: 1fr;
            }

            header {
                flex-direction: column;
                gap: 15px;
            }

            .search-bar input {
                width: 100%;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <header>
            <h1>Gestão de Férias - Enfermagem</h1>
            <div class="search-container">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="Buscar funcionário..." autocomplete="off">
                    <button id="searchButton"><i class="fas fa-search"></i></button>
                </div>
                <div id="searchResultsContainer" class="search-results-container hidden"></div>
            </div>
        </header>

        <section id="alertSection" class="alert hidden">
            <button class="alert-toggle" onclick="toggleAlert()">
                <i class="fas fa-times"></i>
            </button>
            <h3 id="alertMessage"></h3>
        </section>

        <main class="main-layout">
            <div class="left-panel">
                <div class="card">
                    <h2>Cadastrar Funcionário</h2>
                    <form id="employeeForm">
                        <div class="form-group">
                            <label for="name">Nome:</label>
                            <input type="text" id="name" required>
                        </div>
                        <div class="form-group">
                            <label for="role">Função:</label>
                            <select id="role" required>
                                <option value="Técnico em Enfermagem">Técnico em Enfermagem</option>
                                <option value="Enfermeiro">Enfermeiro</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="ward">Enfermaria:</label>
                            <select id="ward" required>
                                <option value="M.A">M.A</option>
                                <option value="LII">LII</option>
                                <option value="LI">LI</option>
                                <option value="CCP">CCP</option>
                                <option value="CSO">CSO</option>
                                <option value="UCI">UCI</option>
                                <option value="A.T">A.T</option>
                                <option value="Ambulatório">Ambulatório</option>
                                <option value="Curativo">Curativo</option>
                                <option value="SCIH">SCIH</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="shift">Turno:</label>
                            <select id="shift" required>
                                <option value="Manhã">Manhã</option>
                                <option value="Tarde">Tarde</option>
                                <option value="Noite">Noite</option>
                            </select>
                        </div>
                        <button type="submit" id="submitButton">Adicionar Funcionário</button>
                    </form>
                </div>
            </div>

            <div class="right-panel">
                <div class="vacation-section">
                    <div class="vacation-card">
                        <div class="toggle-header" onclick="toggleSection('currentVacations')">
                            <h3>Férias do Mês Atual</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div id="currentVacations" class="toggle-content"></div>
                    </div>
                    <div class="vacation-card">
                        <div class="toggle-header" onclick="toggleSection('nextVacations')">
                            <h3>Próximas Férias</h3>
                            <i class="fas fa-chevron-down"></i>
                        </div>
                        <div id="nextVacations" class="toggle-content"></div>
                    </div>
                </div>
            </div>
        </main>

        <section class="board-section">
            <div id="wardsNavbar" class="wards-navbar"></div>
            <div id="shiftFilter" class="shift-filter"></div>
            <div id="employeesBoard" class="employees-board"></div>
        </section>
    </div>

    <!-- Modal de Férias -->
    <div id="vacationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Registrar Férias</h2>
                <span class="close">&times;</span>
            </div>
            <form id="vacationForm">
                <input type="hidden" id="vacationEmployeeId">
                <div class="form-group">
                    <label for="vacationStart">Início das Férias:</label>
                    <input type="date" id="vacationStart" required>
                </div>
                <div class="form-group">
                    <label for="vacationDays">Dias de Férias:</label>
                    <input type="number" id="vacationDays" min="1" max="30" value="30" required>
                </div>
                <div class="form-group">
                    <label for="vacationEnd">Término das Férias:</label>
                    <input type="date" id="vacationEnd" readonly>
                </div>
                <button type="submit">Salvar Férias</button>
            </form>
        </div>
    </div>

    <!-- Modal de Confirmação -->
    <div id="confirmationModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Confirmação</h2>
                <span class="close">&times;</span>
            </div>
            <p id="confirmationMessage"></p>
            <div class="confirmation-buttons">
                <button id="confirmYes">Sim</button>
                <button id="confirmNo">Não</button>
            </div>
        </div>
    </div>

    <footer>
        Criado e desenvolvido por Hipócrates Matheus
    </footer>

    <!-- Firebase -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // ================== CONFIGURAÇÃO DO FIREBASE ==================
        // ⚠️ SUBSTITUA COM SUAS CREDENCIAIS REAIS DO FIREBASE!
        const firebaseConfig = {
            apiKey: "AIzaSyDd1lBoSFXMCYnV6PiP_v51StGUZgD-eMw",
            authDomain: "ferias-enfermagem.firebaseapp.com",
            projectId: "ferias-enfermagem",
            storageBucket: "ferias-enfermagem.firebasestorage.app",
            messagingSenderId: "265712802426",
            appId: "1:265712802426:web:4b1f39a4568d7a911e39c3"
        };

        // Inicializar Firebase
        firebase.initializeApp(firebaseConfig);
        const db = firebase.firestore();

        // ================== VARIÁVEIS GLOBAIS ==================
        let employees = [];
        let vacations = [];
        let selectedWard = null;
        let selectedShift = null;

        // ================== FUNÇÕES DO FIREBASE ==================
        async function saveEmployee(employee) {
            try {
                // Verificar se nome já existe
                const nomeExistente = employees.find(emp =>
                    emp.name.toLowerCase() === employee.name.toLowerCase() && emp.id !== employee.id
                );

                if (nomeExistente) {
                    throw new Error("Já existe um funcionário com este nome!");
                }

                if (employee.id && employee.id.startsWith('firebase_')) {
                    // Atualizar funcionário existente
                    const firebaseId = employee.id.replace('firebase_', '');
                    await db.collection('employees').doc(firebaseId).set(employee);
                    return employee.id;
                } else {
                    // Criar novo funcionário
                    const docRef = await db.collection('employees').add(employee);
                    return 'firebase_' + docRef.id;
                }
            } catch (error) {
                console.error("Erro ao salvar no Firebase:", error);
                throw error;
            }
        }

        async function loadEmployees() {
            try {
                const snapshot = await db.collection('employees').get();
                employees = [];
                snapshot.forEach(doc => {
                    employees.push({ id: 'firebase_' + doc.id, ...doc.data() });
                });
                return employees;
            } catch (error) {
                console.error("Erro ao carregar funcionários:", error);
                return [];
            }
        }

        async function saveVacation(vacation) {
            try {
                if (vacation.id && vacation.id.startsWith('firebase_')) {
                    const firebaseId = vacation.id.replace('firebase_', '');
                    await db.collection('vacations').doc(firebaseId).set(vacation);
                    return vacation.id;
                } else {
                    const docRef = await db.collection('vacations').add(vacation);
                    return 'firebase_' + docRef.id;
                }
            } catch (error) {
                console.error("Erro ao salvar férias:", error);
                throw error;
            }
        }

        async function loadVacations() {
            try {
                const snapshot = await db.collection('vacations').get();
                vacations = [];
                snapshot.forEach(doc => {
                    vacations.push({ id: 'firebase_' + doc.id, ...doc.data() });
                });
                return vacations;
            } catch (error) {
                console.error("Erro ao carregar férias:", error);
                return [];
            }
        }

        // ================== FUNÇÕES DE UI/UX ==================
        function toggleSection(sectionId) {
            const section = document.getElementById(sectionId);
            const icon = section.previousElementSibling.querySelector('i');

            section.classList.toggle('hidden');
            icon.classList.toggle('fa-chevron-down');
            icon.classList.toggle('fa-chevron-up');
        }

        function toggleAlert() {
            const alertSection = document.getElementById('alertSection');
            alertSection.classList.add('hidden');
        }

        // ================== FUNÇÕES PRINCIPAIS ==================
        function initializeApp() {
            setupEventListeners();
            loadAllData();
            renderWardsNavbar();
            renderShiftFilter();
        }

        async function loadAllData() {
            employees = await loadEmployees();
            vacations = await loadVacations();
            renderEmployeesBoard();
            renderVacationLists();
            checkRequirements();
        }

        function setupEventListeners() {
            // Formulário de funcionário
            document.getElementById('employeeForm').addEventListener('submit', async function (e) {
                e.preventDefault();
                await addEmployee();
            });

            // Busca
            document.getElementById('searchButton').addEventListener('click', searchEmployee);
            document.getElementById('searchInput').addEventListener('keypress', function (e) {
                if (e.key === 'Enter') {
                    searchEmployee();
                }
            });

            // Cálculo automático de férias
            document.getElementById('vacationStart').addEventListener('change', calculateVacationEnd);
            document.getElementById('vacationDays').addEventListener('input', calculateVacationEnd);
        }

        async function addEmployee() {
            const name = document.getElementById('name').value;
            const role = document.getElementById('role').value;
            const ward = document.getElementById('ward').value;
            const shift = document.getElementById('shift').value;

            // Mostrar loading no botão
            const submitButton = document.getElementById('submitButton');
            submitButton.innerHTML = '<i class="fas fa-spinner fa-spin"></i> Cadastrando...';
            submitButton.disabled = true;

            try {
                const newEmployee = { name, role, ward, shift };
                const employeeId = await saveEmployee(newEmployee);

                // Atualizar a lista
                employees.push({ id: employeeId, ...newEmployee });

                // Limpar apenas o campo do nome, manter os demais
                document.getElementById('name').value = '';

                renderEmployeesBoard();
                checkRequirements();

            } catch (error) {
                alert(error.message);
            } finally {
                // Restaurar botão
                submitButton.innerHTML = 'Adicionar Funcionário';
                submitButton.disabled = false;
            }
        }

        function searchEmployee() {
            const searchTerm = document.getElementById('searchInput').value.toLowerCase();
            const resultsContainer = document.getElementById('searchResultsContainer');

            if (!searchTerm) {
                resultsContainer.classList.add('hidden');
                return;
            }

            const results = employees.filter(emp =>
                emp.name.toLowerCase().includes(searchTerm)
            );

            if (results.length === 0) {
                resultsContainer.innerHTML = '<div class="search-result-item">Nenhum funcionário encontrado</div>';
            } else {
                resultsContainer.innerHTML = results.map(emp => `
                    <div class="search-result-item" data-id="${emp.id}">
                        <div>${emp.name}</div>
                        <small>${emp.role} - ${emp.ward} (${emp.shift})</small>
                    </div>
                `).join('');

                // Adicionar event listeners para os resultados
                resultsContainer.querySelectorAll('.search-result-item').forEach(item => {
                    item.addEventListener('click', function () {
                        const employeeId = this.getAttribute('data-id');
                        const employee = employees.find(emp => emp.id === employeeId);
                        if (employee) {
                            selectWard(employee.ward);
                            selectShift(employee.shift);
                            resultsContainer.classList.add('hidden');
                        }
                    });
                });
            }

            resultsContainer.classList.remove('hidden');
        }

        // ================== OUTRAS FUNÇÕES ==================
        function calculateVacationEnd() {
            const startDate = new Date(document.getElementById('vacationStart').value);
            const days = parseInt(document.getElementById('vacationDays').value);

            if (isNaN(startDate.getTime()) || isNaN(days)) {
                document.getElementById('vacationEnd').value = '';
                return;
            }

            const endDate = new Date(startDate);
            endDate.setDate(endDate.getDate() + days);

            document.getElementById('vacationEnd').value = endDate.toISOString().split('T')[0];
        }

        function isOnVacation(employeeId) {
            const now = new Date();
            const employeeVacation = vacations.find(v => v.employeeId === employeeId);

            if (!employeeVacation) return false;

            const startDate = new Date(employeeVacation.start);
            const endDate = new Date(employeeVacation.end);

            return now >= startDate && now <= endDate;
        }

        function renderVacationLists() {
            const now = new Date();
            const currentMonth = now.getMonth();
            const currentYear = now.getFullYear();
            const nextMonth = currentMonth === 11 ? 0 : currentMonth + 1;
            const nextYear = currentMonth === 11 ? currentYear + 1 : currentYear;

            // Férias do mês atual (que começam no mês atual)
            const currentVacations = vacations.filter(v => {
                const startDate = new Date(v.start);
                return startDate.getMonth() === currentMonth && startDate.getFullYear() === currentYear;
            });

            // Próximas férias (que começam no próximo mês)
            const nextVacations = vacations.filter(v => {
                const startDate = new Date(v.start);
                return startDate.getMonth() === nextMonth && startDate.getFullYear() === nextYear;
            });

            // Renderizar férias atuais
            const currentList = document.getElementById('currentVacations');
            if (currentVacations.length === 0) {
                currentList.innerHTML = '<div class="empty-state">Nenhuma férias este mês</div>';
            } else {
                currentList.innerHTML = currentVacations.map(v => {
                    const employee = employees.find(emp => emp.id === v.employeeId);
                    if (!employee) return '';

                    const startDate = new Date(v.start).toLocaleDateString('pt-BR');
                    const endDate = new Date(v.end).toLocaleDateString('pt-BR');

                    return `
                        <div class="vacation-item">
                            <div>${employee.name} (${employee.role})</div>
                            <div>${employee.ward} - ${employee.shift}</div>
                            <div>${startDate} - ${endDate}</div>
                        </div>
                    `;
                }).join('');
            }

            // Renderizar próximas férias
            const nextList = document.getElementById('nextVacations');
            if (nextVacations.length === 0) {
                nextList.innerHTML = '<div class="empty-state">Nenhuma férias no próximo mês</div>';
            } else {
                nextList.innerHTML = nextVacations.map(v => {
                    const employee = employees.find(emp => emp.id === v.employeeId);
                    if (!employee) return '';

                    const startDate = new Date(v.start).toLocaleDateString('pt-BR');
                    const endDate = new Date(v.end).toLocaleDateString('pt-BR');

                    return `
                        <div class="vacation-item">
                            <div>${employee.name} (${employee.role})</div>
                            <div>${employee.ward} - ${employee.shift}</div>
                            <div>${startDate} - ${endDate}</div>
                        </div>
                    `;
                }).join('');
            }
        }

        // ================== FUNÇÕES DE RENDERIZAÇÃO ==================
        function renderWardsNavbar() {
            const wards = ['M.A', 'LII', 'LI', 'CCP', 'CSO', 'UCI', 'A.T', 'Ambulatório', 'Curativo', 'SCIH'];
            const navbar = document.getElementById('wardsNavbar');

            navbar.innerHTML = wards.map(ward => `
                <div class="ward-tab" data-ward="${ward}">${ward}</div>
            `).join('');

            // Adicionar event listeners
            navbar.querySelectorAll('.ward-tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    selectWard(this.getAttribute('data-ward'));
                });
            });
        }

        function renderShiftFilter() {
            const shifts = ['Manhã', 'Tarde', 'Noite'];
            const filter = document.getElementById('shiftFilter');

            filter.innerHTML = shifts.map(shift => `
                <div class="shift-tab" data-shift="${shift}">${shift}</div>
            `).join('');

            // Adicionar event listeners
            filter.querySelectorAll('.shift-tab').forEach(tab => {
                tab.addEventListener('click', function () {
                    selectShift(this.getAttribute('data-shift'));
                });
            });
        }

        function selectWard(ward) {
            selectedWard = ward;
            document.querySelectorAll('.ward-tab').forEach(tab => {
                tab.classList.toggle('active', tab.getAttribute('data-ward') === ward);
            });
            renderEmployeesBoard();
        }

        function selectShift(shift) {
            selectedShift = shift;
            document.querySelectorAll('.shift-tab').forEach(tab => {
                tab.classList.toggle('active', tab.getAttribute('data-shift') === shift);
            });
            renderEmployeesBoard();
        }

        function renderEmployeesBoard() {
            const board = document.getElementById('employeesBoard');
            board.innerHTML = '';

            // Agrupar funcionários por enfermaria e turno
            const groupedEmployees = {};

            employees.forEach(employee => {
                if (selectedWard && employee.ward !== selectedWard) return;
                if (selectedShift && employee.shift !== selectedShift) return;

                const key = `${employee.ward}-${employee.shift}`;
                if (!groupedEmployees[key]) {
                    groupedEmployees[key] = [];
                }
                groupedEmployees[key].push(employee);
            });

            // Renderizar cada grupo
            for (const [key, groupEmployees] of Object.entries(groupedEmployees)) {
                const [ward, shift] = key.split('-');
                const groupElement = document.createElement('div');
                groupElement.className = 'employee-group';

                const title = document.createElement('h3');
                title.textContent = `${ward} - ${shift}`;

                const listElement = document.createElement('div');
                listElement.className = 'employee-list';

                listElement.innerHTML = groupEmployees.map(employee => {
                    const isVacation = isOnVacation(employee.id);

                    return `
                        <div class="employee-item ${isVacation ? 'on-vacation' : ''}" data-id="${employee.id}">
                            <div>
                                <div class="employee-name">${employee.name}</div>
                                <div class="employee-role">${employee.role}</div>
                            </div>
                            <div class="employee-actions">
                                <button class="move-btn" title="Mover" onclick="openMoveModal('${employee.id}')">
                                    <i class="fas fa-exchange"></i>
                                </button>
                                <button class="edit-btn" title="Editar férias" onclick="openVacationModal('${employee.id}')">
                                    <i class="fas fa-umbrella-beach"></i>
                                </button>
                                <button class="delete-btn" title="Excluir" onclick="confirmDeleteEmployee('${employee.id}')">
                                    <i class="fas fa-trash"></i>
                                </button>
                            </div>
                        </div>
                    `;
                }).join('');

                groupElement.appendChild(title);
                groupElement.appendChild(listElement);
                board.appendChild(groupElement);
            }
        }

        function checkRequirements() {
            // Requisitos de enfermeiros
            const nurseRequirements = {
                'LII': 2, 'CCP': 2, 'CSO': 2,
                'M.A': 1, 'LI': 1, 'UCI': 1, 'A.T': 1,
                'Ambulatório': 1, 'Curativo': 1, 'SCIH': 1
            };

            // Requisitos de técnicos
            const techRequirements = {
                'M.A': { 'Manhã': 6, 'Tarde': 6, 'Noite': 8 },
                'LII': { 'Manhã': 10, 'Tarde': 10, 'Noite': 12 },
                'LI': { 'Manhã': 5, 'Tarde': 5, 'Noite': 6 },
                'CCP': { 'Manhã': 10, 'Tarde': 10, 'Noite': 14 },
                'CSO': { 'Manhã': 7, 'Tarde': 7, 'Noite': 10 },
                'UCI': { 'Manhã': 5, 'Tarde': 5, 'Noite': 7 },
                'A.T': { 'Manhã': 1, 'Noite': 2 },
                'Ambulatório': { 'Manhã': 9, 'Tarde': 4 },
                'Curativo': { 'Manhã': 2 },
                'SCIH': { 'Manhã': 1 }
            };

            let alerts = [];

            // Verificar enfermeiros
            for (const [ward, minNurses] of Object.entries(nurseRequirements)) {
                const nurses = employees.filter(emp => emp.ward === ward && emp.role === 'Enfermeiro');
                if (nurses.length < minNurses) {
                    alerts.push(`${ward}: ${nurses.length}/${minNurses} enfermeiros`);
                }
            }

            // Verificar técnicos por turno
            for (const [ward, shifts] of Object.entries(techRequirements)) {
                for (const [shift, minTechs] of Object.entries(shifts)) {
                    const techs = employees.filter(emp =>
                        emp.ward === ward && emp.shift === shift && emp.role === 'Técnico em Enfermagem'
                    );
                    if (techs.length < minTechs) {
                        alerts.push(`${ward} - ${shift}: ${techs.length}/${minTechs} técnicos`);
                    }
                }
            }

            // Mostrar alertas se necessário
            const alertSection = document.getElementById('alertSection');
            const alertMessage = document.getElementById('alertMessage');

            if (alerts.length > 0) {
                alertMessage.innerHTML = `Requisitos mínimos não atendidos:<br>${alerts.join('<br>')}`;
                alertSection.classList.remove('hidden');
            } else {
                alertSection.classList.add('hidden');
            }
        }

        // ================== INICIALIZAÇÃO ==================
        document.addEventListener('DOMContentLoaded', function () {
            initializeApp();
        });

        // Funções para modais (para completar)
        function openVacationModal(employeeId) {
            // Implementar abertura do modal de férias
            console.log("Abrir modal de férias para:", employeeId);
        }

        function openMoveModal(employeeId) {
            // Implementar abertura do modal de mover
            console.log("Abrir modal de mover para:", employeeId);
        }

        function confirmDeleteEmployee(employeeId) {
            // Implementar confirmação de exclusão
            console.log("Confirmar exclusão de:", employeeId);
        }
    </script>
</body>

</html>